<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>From the time that I almost helped people with Corona symptoms | wtimme</title><meta name=keywords content><meta name=description content="Or: How I learned to avoid PDF parsing"><meta name=author content><link rel=canonical href=https://wtimme.github.io/posts/kvhh-covid-check/><link href=/assets/css/stylesheet.min.1eef9c740af75b4e5f773d9d5f757e03e3df71f3a308e73070cc73d55a59a7d7.css integrity="sha256-Hu+cdAr3W05fdz2dX3V+A+PfcfOjCOcwcMxz1VpZp9c=" rel="preload stylesheet" as=style><link rel=icon href=https://wtimme.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://wtimme.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://wtimme.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://wtimme.github.io/apple-touch-icon.png><link rel=mask-icon href=https://wtimme.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><meta property="og:title" content="From the time that I almost helped people with Corona symptoms"><meta property="og:description" content="Or: How I learned to avoid PDF parsing"><meta property="og:type" content="article"><meta property="og:url" content="https://wtimme.github.io/posts/kvhh-covid-check/"><meta property="og:image" content="https://wtimme.github.io/kvhh-covid-check-screenshot.png"><meta property="article:published_time" content="2021-02-28T19:22:56+01:00"><meta property="article:modified_time" content="2021-02-28T19:22:56+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://wtimme.github.io/kvhh-covid-check-screenshot.png"><meta name=twitter:title content="From the time that I almost helped people with Corona symptoms"><meta name=twitter:description content="Or: How I learned to avoid PDF parsing"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://wtimme.github.io/posts/"},{"@type":"ListItem","position":2,"name":"From the time that I almost helped people with Corona symptoms","item":"https://wtimme.github.io/posts/kvhh-covid-check/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"From the time that I almost helped people with Corona symptoms","name":"From the time that I almost helped people with Corona symptoms","description":"In this post, I will talk about how I almost created a web app that helped people with Covid-19 symptoms while I was in quarantine myself. And why it was shut down eventually.\nBack …","keywords":[],"articleBody":"In this post, I will talk about how I almost created a web app that helped people with Covid-19 symptoms while I was in quarantine myself. And why it was shut down eventually.\nBack in mid-2020, when the first “wave” of Corona was hitting Germany and people were getting more and more cautious about personal contact and transmission of the disease, I had just returned home from a long-planned vacation in Germany’s south, in Bavaria. We had camped in a VW bus on camping grounds, and had made sure to keep our distance to other people.\nGetting tested Despite of us being careful, I catched a bug and came down with flu-like symptoms. Friends that I wanted to meet with got worried, and asked me to get tested. Back then, it was relatively new that people got tested, so when the “mobile doctor” arrived at my doorstep with full-on body protection wear, I had the attention of the whole neighborhood.\nAfter the test, I got told to self-quarantine for two days. In addition, the doctor handed me a sheet of paper with a barcode on it, and told me that my result was going to be published as part of a multi-page PDF on the page of the Kassenärztliche Vereinigung Hamburg (KVHH).\nQuerying for results The Corona tests were getting checked by multiple labs across Hamburg. Once or twice a day, each lab would upload a collection of their results as one big (visual) table in a PDF file. That means that patients were required to regularly reload the page in the browser, download the latest set of PDF files and then manually (read: STRG + F) search in the dataset, in the hopes of finding a row with the code that they received from the doctor.\nThere’s got to be an easier way! Now, I am not the kind to just complain about stuff. Rather, I work solution-oriented. Since I had to stay at home due to my self-quarantine, I had 48 hours at my disposal and decided to put them to use.\nI came up with a simple web app (written in Node.js) that allowed patients to search all PDFs using one single input field. Here is how the app worked:\n Every hour, a script would scrape the offical website of the KVV for the PDF files, and download them. Another script (powered by tabula-java) would then extract the tables from the PDF files into CSV files. Afterwards, the website would be updated.  Upon submission of the search form, the web app would look through all of the CSV data that it had gathered, and search for a match. Easy peasy.\nHow it broke The tech-savvy reader might have already flinched when I mentioned the terms “PDF” and “parsing”, and they were right: Extracting the data from the PDF files was the Achilles heel of the whole project, and it was reason I had to shut the service down in the end.\nSee, even advanced programs like tabula-java have their limitations, especially if the formatting of the tables in the PDF files differs, sometimes even in the same document.\nThe KVHH reworked their web page, but kept the different formats and structures of the PDF files. (Heck, they had more important things to focus on, afterall.) Still, I’m a bit bitter because of the value that might project could have brought to patients/Corona testers across Hamburg.\nAftermath In the end, I had to shut the project down. I tried supporting all the different formats, but I was hesitant to publish the information. The whole data was fragile, and even though the results that the web app showed always linked to the source PDF file, and even warned people to only trust the official PDFs, I did not want to risk giving people false hope, or false confidence.\nWith this project, I learned a few things, though, including\n how to utilize Crontab for retrieving remote data, how to crawl HTML with Node.js, how to interact with a Java JAR from within Node.js, and how to push-and-deploy my code to Uberspace  So, even though the repository is no longer maintained and the web app is shut down, my experience was the opposite of my test result: positive\nYou can find the project on GitHub.\n Image attributions:\n “Businessman in mask holding colored bomb in woods” by Erik Mclean via Pexels “Vintage Car Wrecked Grayscale Photo” by Pixabay via Pexels  ","wordCount":"738","inLanguage":"en","image":"https://wtimme.github.io/kvhh-covid-check-screenshot.png","datePublished":"2021-02-28T19:22:56+01:00","dateModified":"2021-02-28T19:22:56+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://wtimme.github.io/posts/kvhh-covid-check/"},"publisher":{"@type":"Organization","name":"wtimme","logo":{"@type":"ImageObject","url":"https://wtimme.github.io/favicon.ico"}}}</script></head><body id=top><script>window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://wtimme.github.io/ accesskey=h title="wtimme (Alt + H)">wtimme</a>
<span class=logo-switches></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://wtimme.github.io/archives/ title=archive><span>archive</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>From the time that I almost helped people with Corona symptoms</h1><div class=post-description>Or: How I learned to avoid PDF parsing</div><div class=post-meta>February 28, 2021</div></header><figure class=entry-cover><img src=https://wtimme.github.io/kvhh-covid-check-screenshot.png alt="Screenshot of the KVHH-Covid-Check web application with the search form visible"></figure><div class=post-content><p>In this post, I will talk about how I almost created a web app that helped people
with Covid-19 symptoms while I was in quarantine myself. And why it was shut down eventually.</p><p>Back in mid-2020, when the first &ldquo;wave&rdquo; of Corona was hitting Germany and people
were getting more and more cautious about personal contact and transmission of
the disease, I had just returned home from a long-planned vacation in Germany&rsquo;s
south, in Bavaria. We had camped in a VW bus on camping grounds, and had made
sure to keep our distance to other people.</p><h2 id=getting-tested>Getting tested<a hidden class=anchor aria-hidden=true href=#getting-tested>#</a></h2><p>Despite of us being careful, I catched a bug and came down with flu-like
symptoms. Friends that I wanted to meet with got worried, and asked me to get
tested. Back then, it was relatively new that people got tested, so when the
&ldquo;mobile doctor&rdquo; arrived at my doorstep with full-on body protection wear, I had
the attention of the whole neighborhood.</p><p><img src=/stock-photos/pexels-erik-mclean-5688586-720x714.jpg alt="Man wearing a mask and handling a smoker" title="The doctor, from the perspective of my neighbors"></p><p>After the test, I got told to self-quarantine for two days. In addition, the
doctor handed me a sheet of paper with a barcode on it, and told me that my
result was going to be published as part of a multi-page PDF on the page of the
<em>Kassenärztliche Vereinigung Hamburg (KVHH)</em>.</p><h2 id=querying-for-results>Querying for results<a hidden class=anchor aria-hidden=true href=#querying-for-results>#</a></h2><p>The Corona tests were getting checked by multiple labs across Hamburg. Once or
twice a day, each lab would upload a collection of their results as one big (visual)
table in a PDF file. That means that patients were required to regularly reload
the page in the browser, download the latest set of PDF files and then manually
(read: <code>STRG</code> + <code>F</code>) search in the dataset, in the hopes of finding a row with
the code that they received from the doctor.</p><h2 id=theres-got-to-be-an-easier-way>There&rsquo;s got to be an easier way!<a hidden class=anchor aria-hidden=true href=#theres-got-to-be-an-easier-way>#</a></h2><p>Now, I am not the kind to just complain about stuff. Rather, I work solution-oriented.
Since I had to stay at home due to my self-quarantine, I had 48 hours at my disposal
and decided to put them to use.</p><p>I came up with a simple web app (written in Node.js) that allowed patients
to search <em>all</em> PDFs using one single input field. Here is how the app worked:</p><ol><li>Every hour, a script would scrape the offical website of the KVV for the PDF files, and download them.</li><li>Another script (powered by <a href=https://github.com/tabulapdf/tabula-java>tabula-java</a>)
would then extract the tables from the PDF files into CSV files.</li><li>Afterwards, the website would be updated.</li></ol><p>Upon submission of the search form, the web app would look through all of the CSV
data that it had gathered, and search for a match. Easy peasy.</p><p><img src=/kvhh-covid-check-result-screenshot.png alt="Screenshot of the web app with a negative test result"></p><h2 id=how-it-broke>How it broke<a hidden class=anchor aria-hidden=true href=#how-it-broke>#</a></h2><p><img src=/stock-photos/pexels-pixabay-78793-720x486.jpg alt="Vintage photo of a wrecked car"></p><p>The tech-savvy reader might have already flinched when I mentioned the terms
&ldquo;PDF&rdquo; and &ldquo;parsing&rdquo;, and they were right: Extracting the data from the PDF files
was the Achilles heel of the whole project, and it was reason I had to shut
the service down in the end.</p><p>See, even advanced programs like <code>tabula-java</code> have their limitations, especially
if the formatting of the tables in the PDF files differs, sometimes even in the
same document.</p><p>The KVHH reworked their web page, but kept the different formats and structures
of the PDF files. (Heck, they had more important things to focus on, afterall.)
Still, I&rsquo;m a bit bitter because of the value that might project could have
brought to patients/Corona testers across Hamburg.</p><h2 id=aftermath>Aftermath<a hidden class=anchor aria-hidden=true href=#aftermath>#</a></h2><p>In the end, I had to shut the project down. I <em>tried</em> supporting all the different
formats, but I was hesitant to publish the information. The whole data was fragile,
and even though the results that the web app showed always linked to the source
PDF file, and even warned people to only trust the official PDFs, I did not want
to risk giving people false hope, or false confidence.</p><p>With this project, I learned a few things, though, including</p><ul><li>how to utilize Crontab for retrieving remote data,</li><li>how to crawl HTML with Node.js,</li><li>how to interact with a Java JAR from within Node.js, and</li><li>how to push-and-deploy my code to Uberspace</li></ul><p>So, even though the repository is no longer maintained and the web app is shut
down, my experience was the opposite of my test result: positive</p><p>You can find <a href=https://github.com/wtimme/kvhh-covid-check>the project on GitHub</a>.</p><hr><p>Image attributions:</p><ul><li><a href=https://www.pexels.com/photo/businessman-in-mask-holding-colored-bomb-in-woods-5688586/>&ldquo;Businessman in mask holding colored bomb in woods&rdquo;</a> by <a href=https://www.pexels.com/@introspectivedsgn>Erik Mclean</a> via <a href=https://www.pexels.com/license/>Pexels</a></li><li><a href=https://www.pexels.com/photo/vintage-car-wrecked-grayscale-photo-78793/>&ldquo;Vintage Car Wrecked Grayscale Photo&rdquo;</a> by <a href=https://www.pexels.com/@pixabay>Pixabay</a> via <a href=https://www.pexels.com/license/>Pexels</a></li></ul></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://wtimme.github.io/>wtimme</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script></body></html>